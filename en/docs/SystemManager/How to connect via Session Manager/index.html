<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-SystemManager/How to connect via Session Manager" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">How to connect via Session Manager? | Piotr Kmita</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://piotrkmita.cloud/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://piotrkmita.cloud/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://piotrkmita.cloud/en/docs/SystemManager/How to connect via Session Manager"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="pl"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How to connect via Session Manager? | Piotr Kmita"><meta data-rh="true" name="description" content="Minimal steps to connect"><meta data-rh="true" property="og:description" content="Minimal steps to connect"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://piotrkmita.cloud/en/docs/SystemManager/How to connect via Session Manager"><link data-rh="true" rel="alternate" href="https://piotrkmita.cloud/en/docs/SystemManager/How to connect via Session Manager" hreflang="en"><link data-rh="true" rel="alternate" href="https://piotrkmita.cloud/docs/SystemManager/How to connect via Session Manager" hreflang="pl"><link data-rh="true" rel="alternate" href="https://piotrkmita.cloud/docs/SystemManager/How to connect via Session Manager" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Piotr Kmita RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Piotr Kmita Atom Feed"><link rel="stylesheet" href="/en/assets/css/styles.70b2fc58.css">
<script src="/en/assets/js/runtime~main.32f17758.js" defer="defer"></script>
<script src="/en/assets/js/main.32197136.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Przejdź do głównej zawartości"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Przejdź do głównej zawartości</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Przełączanie panelu nawigacyjnego" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/devops-2.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/devops-2.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Piotr Kmita</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/SystemManager/introduction">Tutorial</a><a class="navbar__item navbar__link" href="/en/blog">Blog</a><a class="navbar__item navbar__link" href="/en/aboutMe">About me</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/en/docs/SystemManager/How to connect via Session Manager" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/docs/SystemManager/How to connect via Session Manager" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pl">Polski</a></li></ul></div><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Przełącz pomiędzy ciemnym a jasnym motywem (aktualnie ustawiony jasny motyw)" aria-label="Przełącz pomiędzy ciemnym a jasnym motywem (aktualnie ustawiony jasny motyw)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Przewiń do góry" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Panel boczny dokumentów" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/en/docs/SystemManager/introduction">SystemManager</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/SystemManager/introduction">Connection to a public and private instance EC2 via Session Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/SystemManager/Ways of connecting to the server">Ways of connecting to the server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/SystemManager/How to connect via Session Manager">How to connect via Session Manager?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/SystemManager/Servers on a private network without public access">Servers on a private network without public access. Do we need a Bastion host?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/SystemManager/conclusion">Conclusion</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/tutorials">Tutorials</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Pasek nawigacji"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Strona główna" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">SystemManager</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to connect via Session Manager?</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Na tej stronie</button></div><div class="theme-doc-markdown markdown"><h1>How to connect via Session Manager?</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="minimal-steps-to-connect">Minimal steps to connect<a href="#minimal-steps-to-connect" class="hash-link" aria-label="Bezpośredni link do Minimal steps to connect" title="Bezpośredni link do Minimal steps to connect">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssm-agent">SSM Agent<a href="#ssm-agent" class="hash-link" aria-label="Bezpośredni link do SSM Agent" title="Bezpośredni link do SSM Agent">​</a></h3>
<p>Prepare Instance/AMI with installed SSM Agent or use one from this list</p>
<ul>
<li><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/ami-preinstalled-agent.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/ami-preinstalled-agent.html</a></li>
</ul>
<p>Manually installing SSM Agent on EC2 instances for Linux</p>
<p>Example for Centos Stream:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Global resource:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo dnf install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Specific region: us-east-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo dnf install -y https://s3.us-east-1.amazonaws.com/amazon-ssm-us-east-1/latest/linux_amd64/amazon-ssm-agent.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl status amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl enable amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl start amazon-ssm-agent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example for Ubuntu 20.10:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo snap install amazon-ssm-agent --classic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo snap list amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo snap start amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo snap services amazon-ssm-agent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Read more:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-manual-agent-install.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-manual-agent-install.html</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="iam-instance-profile">IAM instance profile<a href="#iam-instance-profile" class="hash-link" aria-label="Bezpośredni link do IAM instance profile" title="Bezpośredni link do IAM instance profile">​</a></h3>
<p>Create an IAM instance profile for Systems Manager and attach IAM role to instance (<a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html</a>)</p>
<p>Create instance profile:</p>
<p>Important:</p>
<ul>
<li>When you create roles for EC2, profile instances are automatically created.</li>
<li>If you create roles via AWS CLI the profile instance is not created. You have to create it manually.</li>
</ul>
<p>What does it look like with the AWS CLI?</p>
<p>You need a trust policy for the role</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOT &gt;&gt; Role-Trust-Policy.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Statement&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Principal&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;Service&quot;: &quot;ec2.amazonaws.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Action&quot;: &quot;sts:AssumeRole&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next you need to create a role with necessary policies, instance profile and attach role to instance profile:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws iam create-role --role-name Role-SSM-instance --assume-role-policy-document file://Role-Trust-Policy.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws iam attach-role-policy --policy-arn arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore --role-name Role-SSM-instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws iam create-instance-profile --instance-profile-name SSM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws iam add-role-to-instance-profile --role-name Role-SSM-instance --instance-profile-name Role-SSM-instance</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can see the result:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws iam list-instance-profiles</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we can associate IAM instance profile to the instance:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws ec2 associate-iam-instance-profile --instance-id INSTANCE_ID --iam-instance-profile Name=SSM </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Read more:</p>
<ul>
<li>IAM roles and instance profile <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html</a></li>
<li>Instance Profile <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/create-instance-profile.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/cli/latest/reference/iam/create-instance-profile.html</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="allow-https-traffic-in-security-group">Allow HTTPS traffic in Security Group<a href="#allow-https-traffic-in-security-group" class="hash-link" aria-label="Bezpośredni link do Allow HTTPS traffic in Security Group" title="Bezpośredni link do Allow HTTPS traffic in Security Group">​</a></h3>
<p>Security group added to VPC endpoint must allow inbound HTTPS (port 443) traffic from the resources in your VPC that communicate with the service. In SG for EC2, we do not need to allow HTTPS traffic just to set up a connection with Session Manager.</p>
<p>The security group must allow inbound HTTPS (port 443) traffic from the resources in your VPC that communicate with the service.</p>
<p>This is an example for AWS CLI:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws ec2 authorize-security-group-ingress \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --group-id sg-ID-Security-Group \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --protocol tcp \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --port 443 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --source-group sg-1a2b3c4d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Read more:</p>
<ul>
<li><a href="https://aws.amazon.com/premiumsupport/knowledge-center/connect-http-https-ec2/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/premiumsupport/knowledge-center/connect-http-https-ec2/</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-instance">Connecting to instance<a href="#connecting-to-instance" class="hash-link" aria-label="Bezpośredni link do Connecting to instance" title="Bezpośredni link do Connecting to instance">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aws-management-console">AWS Management Console<a href="#aws-management-console" class="hash-link" aria-label="Bezpośredni link do AWS Management Console" title="Bezpośredni link do AWS Management Console">​</a></h3>
<p>To start a session (Amazon EC2 console)</p>
<ol>
<li>Open the Amazon EC2 console at <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">https://console.aws.amazon.com/ec2/</a>.</li>
<li>In the navigation pane, choose Instances.</li>
<li>Select the instance and choose Connect.</li>
<li>For Connection method, choose Session Manager.</li>
<li>Choose Connect.</li>
</ol>
<p>Read more:</p>
<ul>
<li>Start a session: <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-sessions-start.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-sessions-start.html</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aws-command-line-interface">AWS Command Line Interface<a href="#aws-command-line-interface" class="hash-link" aria-label="Bezpośredni link do AWS Command Line Interface" title="Bezpośredni link do AWS Command Line Interface">​</a></h3>
<p>You need to use this command from your local instance or CloudShell</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws ssm start-session --target instance-id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Read more:</p>
<ul>
<li>Start a session: <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-sessions-starthtml#sessions-start-cli" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-sessions-starthtml#sessions-start-cli</a></li>
<li>CloudShell <a href="https://aws.amazon.com/cloudshell/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/cloudshell/</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enable-session-logging-to-s3-and-cloudwatch-with-encryption">Enable session logging to S3 and CloudWatch with encryption<a href="#enable-session-logging-to-s3-and-cloudwatch-with-encryption" class="hash-link" aria-label="Bezpośredni link do Enable session logging to S3 and CloudWatch with encryption" title="Bezpośredni link do Enable session logging to S3 and CloudWatch with encryption">​</a></h2>
<p>You can log session commands and details in an Amazon S3 bucket or CloudWatch Logs log group.
Configure sessions on the Session Manager Preferences page for CloudWatch logging or S3 logging.</p>
<p>Important:</p>
<ul>
<li>
<p>Each command together with the output is logged.</p>
</li>
<li>
<p>Logs are only collected for Session Manager connections.</p>
</li>
<li>
<p>The log stream is separate for each session in CloudWatch and have the time when this command executed.</p>
</li>
<li>
<p>The logs are recorded in real time in CloudWatch.</p>
</li>
<li></li>
<li>
<p>In S3 we can see separate files for each session.</p>
</li>
<li>
<p>Logs are recorded after the session ends on S3.</p>
</li>
<li>
<p>On S3 We do not have the time when the command was executed, only the start and end of the session.</p>
</li>
</ul>
<p>Read more:</p>
<ul>
<li>Logging session activity <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-logging.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-logging.html</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-do-we-need-to-do">What do we need to do?<a href="#what-do-we-need-to-do" class="hash-link" aria-label="Bezpośredni link do What do we need to do?" title="Bezpośredni link do What do we need to do?">​</a></h3>
<ul>
<li>General</li>
</ul>
<ol>
<li>Create a KMS key for encryption and set up the key policy to grant permission to the IAM role that will be used for session logging.</li>
<li>Update an IAM policy that allows access to the S3 bucket and CloudWatch Logs for session logging.</li>
</ol>
<ul>
<li>S3</li>
</ul>
<ol>
<li>Create an S3 bucket for storing session logs with encryption.</li>
<li>In the Session Manager settings, enable &quot;Send session logs to S3&quot; and &quot;Choose a bucket name from the list&quot;. You can Enforce encryption.</li>
</ol>
<ul>
<li>CloudWatch</li>
</ul>
<ol>
<li>Create a CloudWatch Log Group for storing session logs with encryption.</li>
<li>Update an IAM policy that allows access to the S3 bucket and CloudWatch Logs for session logging and using KMS key.</li>
<li>In the Session Manager settings, enable &quot;CloudWatch logging&quot;, choose &quot;Stream session logs&quot; and &quot;Choose a log group name from the list&quot;. You can Enforce encryption.</li>
</ol>
<p>Additional ways to configure Session Manager Preferences:</p>
<ul>
<li>AWS CLI</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;schemaVersion&quot;: &quot;1.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;description&quot;: &quot;Document to hold regional settings for Session Manager&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;sessionType&quot;: &quot;Standard_Stream&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;inputs&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;s3BucketName&quot;: &quot;bucket-s3-logs-sessionmanager&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;s3KeyPrefix&quot;: &quot;ec2session&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;s3EncryptionEnabled&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;cloudWatchLogGroupName&quot;: &quot;EC2Session&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;cloudWatchEncryptionEnabled&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;cloudWatchStreamingEnabled&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;kmsKeyId&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;runAsEnabled&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;runAsDefaultUser&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;idleSessionTimeout&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;maxSessionDuration&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;shellProfile&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;windows&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;linux&quot;: &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws ssm update-document --name &quot;SSM-SessionManagerRunShell&quot; --content &quot;file://SessionManagerRunShell.json&quot; --document-version &quot;\$LATEST&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>CloudFormation with CustomResources. Preparing Lambda function and run this. (included configuration in the CloudFormation template).
If you want automated this, you can use this solution. I added to CloudFormation template at the end this file.
Brief information: During CF create, there are running another stack with EC2 instance. To EC2 instnane you send the command. You can put Log group name to create and collect logs from this instance. This is usefull during occurs the problems. You need to prepare IAM role/ Instance Profile for this EC2 with necessary permission to run the command. Unfortuantely this take more time to finish the CF stack.</p>
</li>
<li>
<p>Using AWSUtility::CloudFormation::CommandRunner. This creates an instance EC2 to run the command.</p>
</li>
</ul>
<p>Read more:</p>
<ul>
<li>AWSUtility::CloudFormation::CommandRunner <a href="https://aws.amazon.com/premiumsupport/knowledge-center/cloudformation-commandrunner-stack/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/premiumsupport/knowledge-center/cloudformation-commandrunner-stack/</a></li>
<li><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/getting-started-configure-preferences-cli.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/getting-started-configure-preferences-cli.html</a></li>
</ul>
<p><strong>Warnning:</strong><br>
<!-- -->In this case, there is a potential risk of data leakage. Imagine setting up a configuration under SSM Prefernace and collecting logs in S3 without forcing encryption. We resigned from the solution and we deleted the S3. External account create the bucket S3 with the same name what in our configuration. What is happening?
Our logs are saved to this bucket! This is our all session. We can open some confidential file or all share our configuration.</p>
<p>If we use &quot;Enforce encryption&quot; we can get this error:
Your session has been terminated for the following reasons: Couldn&#x27;t start the session because we are unable to validate encryption on Amazon S3 bucket. Error: AccessDenied: Access Denied status code: 403</p>
<p>If not we can put session file to bucket, where permission are appropriate.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Bezpośredni link do Troubleshooting" title="Bezpośredni link do Troubleshooting">​</a></h2>
<ol>
<li>One of the less transparent cases that can occur:</li>
</ol>
<blockquote>
<p>Your session has been terminated for the following reasons: We couldn&#x27;t start the session because encryption is not set up on the selected CloudWatch Logs log group. Either encrypt the log group or choose an option to enable logging without encryption.</p>
</blockquote>
<p>and a sample solution:</p>
<blockquote>
<p>Add a policy to the IAM instance profile that is attached to your instance granting permission to upload encrypted logs to CloudWatch</p>
</blockquote>
<p>Read more:</p>
<ul>
<li>CloudWatch <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html</a></li>
<li>Create a custom IAM role for Session Manager <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/getting-started-create-iam-instance-profile.html#create-iam-instance-profile-ssn-logging" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/systems-manager/latest/userguide/getting-started-create-iam-instance-profile.html#create-iam-instance-profile-ssn-logging</a></li>
<li>Troubleshoot <a href="https://aws.amazon.com/premiumsupport/knowledge-center/ssm-session-manager-failures/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/premiumsupport/knowledge-center/ssm-session-manager-failures/</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/SystemManager/03-How to connect via Session Manager.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edytuj tę stronę</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Strona dokumentacji"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/SystemManager/Ways of connecting to the server"><div class="pagination-nav__sublabel">Poprzednia strona</div><div class="pagination-nav__label">Ways of connecting to the server</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/SystemManager/Servers on a private network without public access"><div class="pagination-nav__sublabel">Następna strona</div><div class="pagination-nav__label">Servers on a private network without public access. Do we need a Bastion host?</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#minimal-steps-to-connect" class="table-of-contents__link toc-highlight">Minimal steps to connect</a><ul><li><a href="#ssm-agent" class="table-of-contents__link toc-highlight">SSM Agent</a></li><li><a href="#iam-instance-profile" class="table-of-contents__link toc-highlight">IAM instance profile</a></li><li><a href="#allow-https-traffic-in-security-group" class="table-of-contents__link toc-highlight">Allow HTTPS traffic in Security Group</a></li></ul></li><li><a href="#connecting-to-instance" class="table-of-contents__link toc-highlight">Connecting to instance</a><ul><li><a href="#aws-management-console" class="table-of-contents__link toc-highlight">AWS Management Console</a></li><li><a href="#aws-command-line-interface" class="table-of-contents__link toc-highlight">AWS Command Line Interface</a></li></ul></li><li><a href="#enable-session-logging-to-s3-and-cloudwatch-with-encryption" class="table-of-contents__link toc-highlight">Enable session logging to S3 and CloudWatch with encryption</a><ul><li><a href="#what-do-we-need-to-do" class="table-of-contents__link toc-highlight">What do we need to do?</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Certificates</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/">Certificate 1</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social media</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Piotr Kmita. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>