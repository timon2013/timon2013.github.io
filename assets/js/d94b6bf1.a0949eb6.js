"use strict";(self.webpackChunkpersonal_site=self.webpackChunkpersonal_site||[]).push([[5575],{5122:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var a=s(4848),i=s(8453);const o={},t="Sposoby \u0142\u0105czenia si\u0119 z serwerem",r={id:"SystemManager/Ways of connecting to the server",title:"Sposoby \u0142\u0105czenia si\u0119 z serwerem",description:"Mo\u017cemy korzysta\u0107 z wielu sposob\xf3w, aby po\u0142\u0105czy\u0107 si\u0119 z serwerem. AWS oferuje nam kilka opcji, kt\xf3re opisuj\u0119 poni\u017cej.",source:"@site/docs/SystemManager/02-Ways of connecting to the server.md",sourceDirName:"SystemManager",slug:"/SystemManager/Ways of connecting to the server",permalink:"/docs/SystemManager/Ways of connecting to the server",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/SystemManager/02-Ways of connecting to the server.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Po\u0142\u0105czenie z instancj\u0105 publiczn\u0105 i prywatn\u0105 EC2 za pomoc\u0105 Session Manager",permalink:"/docs/SystemManager/introduction"},next:{title:"Jak po\u0142\u0105czy\u0107 si\u0119 za pomoc\u0105 Session Manager?",permalink:"/docs/SystemManager/How to connect via Session Manager"}},c={},l=[{value:"EC2 Instance Connect",id:"ec2-instance-connect",level:2},{value:"Session Manager",id:"session-manager",level:2},{value:"Klient SSH",id:"klient-ssh",level:2},{value:"Konsola szeregowa EC2",id:"konsola-szeregowa-ec2",level:2},{value:"Jak odzyska\u0107 dost\u0119p do serwera?",id:"jak-odzyska\u0107-dost\u0119p-do-serwera",level:3},{value:"Ustawianie has\u0142a dla lokalnego u\u017cytkownika na EC2",id:"ustawianie-has\u0142a-dla-lokalnego-u\u017cytkownika-na-ec2",level:4}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"sposoby-\u0142\u0105czenia-si\u0119-z-serwerem",children:"Sposoby \u0142\u0105czenia si\u0119 z serwerem"})}),"\n",(0,a.jsx)(n.p,{children:"Mo\u017cemy korzysta\u0107 z wielu sposob\xf3w, aby po\u0142\u0105czy\u0107 si\u0119 z serwerem. AWS oferuje nam kilka opcji, kt\xf3re opisuj\u0119 poni\u017cej."}),"\n",(0,a.jsx)(n.h2,{id:"ec2-instance-connect",children:"EC2 Instance Connect"}),"\n",(0,a.jsx)(n.p,{children:"Wa\u017cne:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Nie musisz udost\u0119pnia\u0107 i zarz\u0105dza\u0107 kluczami SSH."}),"\n",(0,a.jsx)(n.li,{children:"Instancja musi mie\u0107 publiczny adres IPv4."}),"\n",(0,a.jsx)(n.li,{children:"Mo\u017cesz po\u0142\u0105czy\u0107 si\u0119 z instancj\u0105 przez prywatn\u0105 sie\u0107 za pomoc\u0105 EC2 Instance Connect CLI z innych serwer\xf3w."}),"\n",(0,a.jsx)(n.li,{children:"Jako nazw\u0119 u\u017cytkownika mo\u017cesz poda\u0107 dowolnego u\u017cytkownika, kt\xf3ry istnieje w systemie i ma uprawnienia do logowania."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Wi\u0119cej informacji:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Connect-using-EC2-Instance-Connect.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Connect-using-EC2-Instance-Connect.html"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"session-manager",children:"Session Manager"}),"\n",(0,a.jsx)(n.p,{children:"Session Manager to w pe\u0142ni zarz\u0105dzana funkcja AWS Systems Manager, kt\xf3ra pozwala zarz\u0105dza\u0107 instancjami Amazon EC2 za pomoc\u0105 interaktywnej przegl\u0105darkowej pow\u0142oki lub za pomoc\u0105 AWS CLI."}),"\n",(0,a.jsx)(n.p,{children:"Wa\u017cne:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Agent SSM powinien by\u0107 zainstalowany na instancji."}),"\n",(0,a.jsx)(n.li,{children:"Nale\u017cy utworzy\u0107 profil IAM Instance i przypisa\u0107 rol\u0119 IAM do instancji."}),"\n",(0,a.jsx)(n.li,{children:"Grupa bezpiecze\u0144stwa dodana do punktu ko\u0144cowego VPC musi zezwala\u0107 na ruch przychodz\u0105cy HTTPS (port 443) z zasob\xf3w w Twoim VPC, kt\xf3re komunikuj\u0105 si\u0119 z us\u0142ug\u0105."}),"\n",(0,a.jsx)(n.li,{children:"W\u0142\u0105czenie prywatnego DNS wymaga ustawienia atrybut\xf3w enableDnsSupport i enableDnsHostnames na true dla VPC."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Przyk\u0142ad po\u0142\u0105czenia za pomoc\u0105 AWS CLI:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"aws ssm start-session --target INSTANCE_ID\n"})}),"\n",(0,a.jsx)(n.p,{children:"Wi\u0119cej informacji:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Agent SSM ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html",children:"https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html"})]}),"\n",(0,a.jsxs)(n.li,{children:["Session Manager ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/session-manager.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/session-manager.html"})]}),"\n",(0,a.jsxs)(n.li,{children:["Profil Instance ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html",children:"https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html"})]}),"\n",(0,a.jsxs)(n.li,{children:["Przypisanie roli IAM ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html#attach-iam-role",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html#attach-iam-role"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"klient-ssh",children:"Klient SSH"}),"\n",(0,a.jsx)(n.p,{children:"Wa\u017cne:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Musisz udost\u0119pnia\u0107 i zarz\u0105dza\u0107 kluczami SSH."}),"\n",(0,a.jsx)(n.li,{children:"Grupa bezpiecze\u0144stwa musi zezwala\u0107 na ruch przychodz\u0105cy SSH (port 22)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Przyk\u0142ad po\u0142\u0105czenia:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ssh -i /path/key-pair-name.pem instance-user-name@instance-public-dns-name\n"})}),"\n",(0,a.jsx)(n.p,{children:"Wi\u0119cej informacji:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Putty ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html"})]}),"\n",(0,a.jsxs)(n.li,{children:["OpenSSH ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/openssh.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/openssh.html"})]}),"\n",(0,a.jsxs)(n.li,{children:["WSL ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/WSL.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/WSL.html"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"konsola-szeregowa-ec2",children:"Konsola szeregowa EC2"}),"\n",(0,a.jsx)(n.p,{children:"Wa\u017cne:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:'Musisz zezwoli\u0107 na "Konsol\u0119 szeregow\u0105 EC2" w "Ustawieniach EC2".'}),"\n",(0,a.jsx)(n.li,{children:"Musimy mie\u0107 mo\u017cliwo\u015b\u0107 zalogowania si\u0119 na serwer z lokalnej konsoli. Logowanie za pomoc\u0105 has\u0142a."}),"\n",(0,a.jsx)(n.li,{children:"Musimy u\u017cywa\u0107 typu instancji opartego na systemie AWS Nitro."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Kiedy u\u017cywa\u0107?"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Kiedy chcemy zmieni\u0107 has\u0142o."}),"\n",(0,a.jsx)(n.li,{children:"Kiedy chcemy odzyska\u0107 dost\u0119p do serwera."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"W\u0142\u0105cz konsol\u0119 szeregow\u0105 EC2:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"aws ec2 enable-serial-console-access --region us-east-1\n"})}),"\n",(0,a.jsx)(n.p,{children:"Wi\u0119cej informacji:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Konfiguracja dost\u0119pu do konsoli szeregowej EC2 ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configure-access-to-serial-console.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configure-access-to-serial-console.html"})]}),"\n",(0,a.jsxs)(n.li,{children:["Instancje oparte na systemie Nitro ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.htmlicmpid=docs_ec2_console#ec2-nitro-instances",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.htmlicmpid=docs_ec2_console#ec2-nitro-instances"})]}),"\n",(0,a.jsxs)(n.li,{children:["Domy\u015blni u\u017cytkownicy: ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/managing-users.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/managing-users.html"})]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"jak-odzyska\u0107-dost\u0119p-do-serwera",children:"Jak odzyska\u0107 dost\u0119p do serwera?"}),"\n",(0,a.jsx)(n.p,{children:"Przypadek:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Nie mamy kluczy SSH."}),"\n",(0,a.jsx)(n.li,{children:"Serwer SSH nie dzia\u0142a."}),"\n",(0,a.jsx)(n.li,{children:"Nie mamy has\u0142a do u\u017cytkownika."}),"\n",(0,a.jsx)(n.li,{children:"Agent SSM nie zosta\u0142 zainstalowany."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:'Domy\u015blnie w obrazie Amazon Linux 2 nie jest generowane has\u0142o dla u\u017cytkownika "ec2-user". Mo\u017cemy ustawi\u0107 to has\u0142o, doda\u0107 klucz publiczny SSH lub naprawi\u0107 inne problemy.'}),"\n",(0,a.jsx)(n.p,{children:"Mamy kilka popularnych sposob\xf3w, aby to zrobi\u0107:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Utw\xf3rz AMI z uszkodzonego serwera/EBS i utw\xf3rz nowy serwer z AMI."}),"\n",(0,a.jsx)(n.li,{children:"Wy\u0142\u0105cz instancj\u0119, od\u0142\u0105cz EBS i pod\u0142\u0105cz EBS do nowego tymczasowego serwera, gdzie mo\u017cemy naprawi\u0107 us\u0142ugi/pliki na tym EBS."}),"\n",(0,a.jsx)(n.li,{children:"Ustaw has\u0142o dla lokalnego u\u017cytkownika."}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"ustawianie-has\u0142a-dla-lokalnego-u\u017cytkownika-na-ec2",children:"Ustawianie has\u0142a dla lokalnego u\u017cytkownika na EC2"}),"\n",(0,a.jsx)(n.p,{children:'Mo\u017cemy u\u017cy\u0107 "User data" do tego celu. Domy\u015blnie dane u\u017cytkownika dzia\u0142aj\u0105 podczas pierwszego uruchomienia serwera.'}),"\n",(0,a.jsx)(n.p,{children:"Mo\u017cemy uruchomi\u0107 nast\u0119puj\u0105ce polecenie, aby ustawi\u0107 has\u0142o dla u\u017cytkownika ec2-user:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:' echo "has\u0142o" | passwd --stdin ec2-user\n'})}),"\n",(0,a.jsx)(n.p,{children:"Przyk\u0142ad skryptu, kt\xf3ry uruchamia si\u0119 raz:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n/bin/echo "Hello World" >> /tmp/helloworld.txt\necho "has\u0142o" | passwd --stdin ec2-user\n'})}),"\n",(0,a.jsx)(n.p,{children:"Co powinni\u015bmy zrobi\u0107?"}),"\n",(0,a.jsx)(n.p,{children:'Mo\u017cemy doda\u0107 nast\u0119puj\u0105cy skrypt do "User data", kt\xf3ry uruchamia si\u0119 za ka\u017cdym razem, gdy serwer si\u0119 uruchamia:'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'Content-Type: multipart/mixed; boundary="//"\nMIME-Version: 1.0\n\n--//\nContent-Type: text/cloud-config; charset="us-ascii"\nMIME-Version: 1.0\nContent-Transfer-Encoding: 7bit\nContent-Disposition: attachment; filename="cloud-config.txt"\n\n#cloud-config\ncloud_final_modules:\n- [scripts-user, always]\n\n--//\nContent-Type: text/x-shellscript; charset="us-ascii"\nMIME-Version: 1.0\nContent-Transfer-Encoding: 7bit\nContent-Disposition: attachment; filename="userdata.txt"\n\n#!/bin/bash\necho "has\u0142o" | passwd --stdin ec2-user\n\n--//--\n'})}),"\n",(0,a.jsx)(n.p,{children:"To ustawia has\u0142o (has\u0142o) dla u\u017cytkownika ec2-user."}),"\n",(0,a.jsx)(n.p,{children:"Wi\u0119cej informacji:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html",children:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://aws.amazon.com/premiumsupport/knowledge-center/execute-user-data-ec2/",children:"https://aws.amazon.com/premiumsupport/knowledge-center/execute-user-data-ec2/"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>r});var a=s(6540);const i={},o=a.createContext(i);function t(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);